import{a as F,r as A,x as B,c as p,o as i,b as e,m as D,F as x,j as V,t as w,i as P,h as b,v as f,u as s,f as k,w as y,l as g,e as E,k as M,d as W,q as G,g as J,n as _,T as K,p as j}from"./app-DSV-km4U.js";import{_ as Q}from"./AuthenticatedLayout-KoLITSzp.js";import{a as c,E as N}from"./AssetTransferHistory.vue_vue_type_style_index_0_lang-NKUp1K70.js";import"./ApplicationLogo-Dp_VyYtF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"min-w-full divide-y divide-gray-200 text-sm"},Y={class:"bg-white divide-y divide-gray-200"},Z={class:"px-4 py-2 whitespace-nowrap"},h={class:"px-4 py-2 whitespace-nowrap"},ee={class:"px-4 py-2 whitespace-nowrap"},te={class:"px-4 py-2 whitespace-nowrap"},le={class:"px-4 py-2 whitespace-nowrap space-x-2"},se=["onClick"],oe=["onClick"],ae=["onClick"],re={key:0},ne={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4"},de={class:"bg-white p-6 rounded shadow-lg w-full max-w-2xl relative"},ie={class:"text-lg font-semibold mb-4"},ue={class:"md:col-span-2"},me={class:"col-span-2 flex justify-end space-x-2 mt-4"},be={type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},pe={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4"},fe={class:"bg-white p-6 rounded shadow-lg max-w-sm w-full relative"},ve={class:"flex justify-end space-x-2"},ye={__name:"AssetTransferHistory",props:{transfers:Array,users:Array,locations:Array,asset:Object},setup(d){const U=[...F().url.matchAll(/\/assets\/(\d+)/g)],v=U.length>0?U[U.length-1][1]:"";console.log("Asset ID:",v);const u=A(!1),n=A(!1),C=A(!1),S=A(null),T=d,r=B({id:null,asset_id:"",from_user_id:null,to_user_id:null,from_location:null,to_location:null,transfer_date:"",approved_by:"",reason:"",user_status:""}),t=()=>{r.reset(),n.value=!1,r.asset_id=v,u.value=!0},o=m=>{var l;r.id=m.id,r.asset_id=m.asset_id??((l=T.asset)==null?void 0:l.id)??"",r.from_user_id=m.from_user_id,r.to_user_id=m.to_user_id,r.from_location=m.from_location,r.to_location=m.to_location,r.transfer_date=m.transfer_date,r.approved_by=m.approved_by,r.reason=m.reason,r.user_status=m.user_status,n.value=!0,u.value=!0},H=m=>{S.value=m,C.value=!0},I=()=>{n.value?r.put(route("asset-transfers.update",r.id),{onSuccess:()=>u.value=!1,onError:m=>console.error("Update error:",m)}):r.post(route("asset-transfers.store"),{onSuccess:()=>u.value=!1,onError:m=>console.error("Create error:",m)})},O=()=>{S.value&&r.delete(`/asset-transfers/${S.value}`,{onSuccess:()=>{C.value=!1,S.value=null},onError:m=>console.error("Delete error:",m)})},q=m=>{const l=`/public/ppi-asset/public/asset-transfers/${m}/print`;window.open(l,"_blank")};return(m,l)=>(i(),p(x,null,[e("div",{class:"mb-4 text-right"},[e("button",{onClick:t,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," + Add Transfer ")]),e("table",X,[l[11]||(l[11]=e("thead",null,[e("tr",{class:"bg-gray-50"},[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned User"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reason"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Y,[(i(!0),p(x,null,V(d.transfers,a=>{var L,R;return i(),p("tr",{key:a.id},[e("td",Z,w(new Date(a.transfer_date).toLocaleDateString()),1),e("td",h,w(((L=d.users.find($=>$.id===a.to_user_id))==null?void 0:L.name)||((R=d.users.find($=>$.id===a.from_user_id))==null?void 0:R.name)||"N/A"),1),e("td",ee,w(a.user_status),1),e("td",te,w(a.reason||"-"),1),e("td",le,[e("button",{onClick:$=>o(a),class:"text-indigo-600 hover:underline"},"Edit",8,se),e("button",{onClick:$=>H(a.id),class:"text-red-600 hover:underline"},"Delete",8,oe),e("button",{onClick:$=>q(a.id),class:"text-green-600 hover:underline"},"Print",8,ae)])])}),128)),d.transfers.length===0?(i(),p("tr",re,l[10]||(l[10]=[e("td",{colspan:"5",class:"px-4 py-2 text-center text-gray-500"},"No transfer history found.",-1)]))):D("",!0)])]),u.value?(i(),p("div",ne,[e("div",de,[e("h2",ie,w(n.value?"Edit Transfer":"Create Transfer"),1),e("form",{onSubmit:P(I,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[e("div",null,[l[12]||(l[12]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Asset ID",-1)),b(e("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>s(r).asset_id=a),class:"border p-2 rounded w-full bg-gray-100",readonly:""},null,512),[[f,s(r).asset_id]])]),e("div",null,[l[14]||(l[14]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"From User",-1)),k(s(N),{modelValue:s(r).from_user_id,"onUpdate:modelValue":l[1]||(l[1]=a=>s(r).from_user_id=a),placeholder:"-- Select User --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.users&&d.users.length>0?(i(!0),p(x,{key:0},V(d.users,a=>(i(),g(s(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(s(c),{key:1,disabled:"",value:""},{default:y(()=>l[13]||(l[13]=[E("No users available")])),_:1,__:[13]}))]),_:1},8,["modelValue"])]),e("div",null,[l[16]||(l[16]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"To User",-1)),k(s(N),{modelValue:s(r).to_user_id,"onUpdate:modelValue":l[2]||(l[2]=a=>s(r).to_user_id=a),placeholder:"-- Select User --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.users&&d.users.length>0?(i(!0),p(x,{key:0},V(d.users,a=>(i(),g(s(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(s(c),{key:1,disabled:"",value:""},{default:y(()=>l[15]||(l[15]=[E("No users available")])),_:1,__:[15]}))]),_:1},8,["modelValue"])]),e("div",null,[l[18]||(l[18]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"From Location",-1)),k(s(N),{modelValue:s(r).from_location,"onUpdate:modelValue":l[3]||(l[3]=a=>s(r).from_location=a),placeholder:"-- Select Location --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.locations&&d.locations.length>0?(i(!0),p(x,{key:0},V(d.locations,a=>(i(),g(s(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(s(c),{key:1,disabled:"",value:""},{default:y(()=>l[17]||(l[17]=[E("No locations available")])),_:1,__:[17]}))]),_:1},8,["modelValue"])]),e("div",null,[l[20]||(l[20]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"To Location",-1)),k(s(N),{modelValue:s(r).to_location,"onUpdate:modelValue":l[4]||(l[4]=a=>s(r).to_location=a),placeholder:"-- Select Location --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.locations&&d.locations.length>0?(i(!0),p(x,{key:0},V(d.locations,a=>(i(),g(s(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(s(c),{key:1,disabled:"",value:""},{default:y(()=>l[19]||(l[19]=[E("No locations available")])),_:1,__:[19]}))]),_:1},8,["modelValue"])]),e("div",null,[l[21]||(l[21]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Transfer Date",-1)),b(e("input",{"onUpdate:modelValue":l[5]||(l[5]=a=>s(r).transfer_date=a),type:"date",class:"border p-2 rounded w-full"},null,512),[[f,s(r).transfer_date]])]),e("div",null,[l[23]||(l[23]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"User Status",-1)),b(e("select",{"onUpdate:modelValue":l[6]||(l[6]=a=>s(r).user_status=a),class:"border p-2 rounded w-full"},l[22]||(l[22]=[W('<option disabled value="">-- Select Status --</option><option value="available">Available</option><option value="assigned">Assigned</option><option value="repair">Repair</option><option value="retired">Retired</option>',5)]),512),[[M,s(r).user_status]])]),e("div",ue,[l[24]||(l[24]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Reason",-1)),b(e("textarea",{"onUpdate:modelValue":l[7]||(l[7]=a=>s(r).reason=a),class:"border p-2 rounded w-full"},null,512),[[f,s(r).reason]])]),e("div",me,[e("button",{type:"button",onClick:l[8]||(l[8]=a=>u.value=!1),class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"},"Cancel "),e("button",be,w(n.value?"Update":"Submit"),1)])],32)])])):D("",!0),C.value?(i(),p("div",pe,[e("div",fe,[l[25]||(l[25]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirm Delete",-1)),l[26]||(l[26]=e("p",{class:"mb-6"},"Are you sure you want to delete this transfer record?",-1)),e("div",ve,[e("button",{onClick:l[9]||(l[9]=a=>C.value=!1),class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"},"Cancel"),e("button",{onClick:O,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Delete")])])])):D("",!0)],64))}},xe={class:"max-w-7xl mx-auto p-6 bg-white rounded shadow mt-4"},ge={class:"mb-6 border-b border-gray-200"},ce={class:"flex space-x-6"},ke={key:0,class:"fixed-center bg-green-600 text-white px-6 py-3 rounded shadow-lg z-50"},we=["value"],Ve=["value"],Ue={class:"md:col-span-3"},Ce={class:"md:col-span-3"},Se={class:"md:col-span-3 flex justify-between items-center"},$e=["disabled"],_e={__name:"Edit",props:{asset:Object,users:Array,locations:Array,categories:Array,transfers:Array,next_id:Number,previous_id:Number},setup(d){var T;const{flash:z}=F().props,U=A(!1),v=A("edit"),u=d,n=B({asset_code:u.asset.asset_code,name:u.asset.name,category:((T=u.asset.category)==null?void 0:T.id)??"",model:u.asset.model,serial_number:u.asset.serial_number,vendor:u.asset.vendor,purchase_date:u.asset.purchase_date,purchase_cost:u.asset.purchase_cost,warranty_expiry:u.asset.warranty_expiry,account_id:u.asset.account_id,status:u.asset.status,current_location_id:u.asset.current_location_id,assigned_to_user_id:u.asset.assigned_to_user_id,notes:u.asset.notes,remark:u.asset.remark}),C=G(()=>n.isDirty),S=()=>{var r;if(!((r=u.asset)!=null&&r.id)){console.error("Asset ID is missing. Cannot submit the form.");return}n.put(route("assets.update",u.asset.id),{preserveScroll:!0,onSuccess:()=>{U.value=!0,setTimeout(()=>{U.value=!1},3e3)},onError:t=>{console.error("Form submission failed:",t),alert("There was an error updating the asset. Please check the fields and try again.")}})};return(r,t)=>(i(),p(x,null,[k(s(J),{title:"Edit Asset"}),k(Q,null,{header:y(()=>t[19]||(t[19]=[e("h2",{class:"text-xl font-semibold text-gray-800"},"Edit Asset",-1)])),default:y(()=>[e("div",xe,[e("nav",ge,[e("ul",ce,[e("li",null,[e("button",{onClick:t[0]||(t[0]=o=>v.value="edit"),class:_([v.value==="edit"?"border-b-2 border-blue-600 text-blue-600 font-semibold":"text-gray-600 hover:text-blue-600","pb-2"])}," Edit Asset ",2)]),e("li",null,[e("button",{onClick:t[1]||(t[1]=o=>v.value="transfer"),class:_([v.value==="transfer"?"border-b-2 border-blue-600 text-blue-600 font-semibold":"text-gray-600 hover:text-blue-600","pb-2"])}," Transfer History ",2)]),e("li",null,[e("button",{onClick:t[2]||(t[2]=o=>v.value="repair"),class:_([v.value==="repair"?"border-b-2 border-blue-600 text-blue-600 font-semibold":"text-gray-600 hover:text-blue-600","pb-2"])}," Repair History ",2)])])]),e("div",null,[k(K,{name:"fade"},{default:y(()=>[U.value?(i(),p("div",ke," Asset updated successfully! ")):D("",!0)]),_:1}),b(e("div",null,[e("form",{onSubmit:P(S,["prevent"]),class:"grid grid-cols-1 md:grid-cols-3 gap-6"},[e("div",null,[t[20]||(t[20]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Asset Code",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s(n).asset_code=o),placeholder:"Asset Code",class:"border p-2 rounded w-full"},null,512),[[f,s(n).asset_code]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Name",-1)),b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s(n).name=o),placeholder:"Name",class:"border p-2 rounded w-full"},null,512),[[f,s(n).name]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Category",-1)),b(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>s(n).category=o),class:"border p-2 rounded w-full"},[t[22]||(t[22]=e("option",{disabled:"",value:""},"-- Select Category --",-1)),(i(!0),p(x,null,V(d.categories,o=>(i(),p("option",{key:o.id,value:o.id},w(o.category_name),9,we))),128))],512),[[M,s(n).category]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Model",-1)),b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>s(n).model=o),placeholder:"Model",class:"border p-2 rounded w-full"},null,512),[[f,s(n).model]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Serial Number",-1)),b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>s(n).serial_number=o),placeholder:"Serial Number",class:"border p-2 rounded w-full"},null,512),[[f,s(n).serial_number]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Vendor",-1)),b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>s(n).vendor=o),placeholder:"Vendor",class:"border p-2 rounded w-full"},null,512),[[f,s(n).vendor]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Purchase Date",-1)),b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>s(n).purchase_date=o),type:"date",class:"border p-2 rounded w-full"},null,512),[[f,s(n).purchase_date]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Purchase Cost",-1)),b(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>s(n).purchase_cost=o),type:"number",placeholder:"Cost",class:"border p-2 rounded w-full"},null,512),[[f,s(n).purchase_cost]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Warranty Expiry",-1)),b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>s(n).warranty_expiry=o),type:"date",class:"border p-2 rounded w-full"},null,512),[[f,s(n).warranty_expiry]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"User Status",-1)),b(e("select",{"onUpdate:modelValue":t[12]||(t[12]=o=>s(n).status=o),class:"border p-2 rounded w-full"},t[30]||(t[30]=[e("option",{disabled:"",value:""},"-- Select User Status --",-1),e("option",{value:"instock"},"In Stock",-1),e("option",{value:"using"},"Using",-1),e("option",{value:"repair"},"Repair",-1),e("option",{value:"broken"},"Broken",-1)]),512),[[M,s(n).status]])]),e("div",null,[t[33]||(t[33]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Current Location",-1)),b(e("select",{"onUpdate:modelValue":t[13]||(t[13]=o=>s(n).current_location_id=o),class:"border p-2 rounded w-full"},[t[32]||(t[32]=e("option",{disabled:"",value:""},"-- Select Location --",-1)),(i(!0),p(x,null,V(d.locations,o=>(i(),p("option",{key:o.id,value:o.id},w(o.name),9,Ve))),128))],512),[[M,s(n).current_location_id]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Assigned User",-1)),k(s(N),{modelValue:s(n).assigned_to_user_id,"onUpdate:modelValue":t[14]||(t[14]=o=>s(n).assigned_to_user_id=o),placeholder:"-- Select Assigned User --",class:"w-full",filterable:""},{default:y(()=>[(i(!0),p(x,null,V(d.users,o=>(i(),g(s(c),{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",Ue,[t[35]||(t[35]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Notes",-1)),b(e("textarea",{"onUpdate:modelValue":t[15]||(t[15]=o=>s(n).notes=o),placeholder:"Notes",class:"border p-2 rounded w-full"},null,512),[[f,s(n).notes]])]),e("div",Ce,[t[36]||(t[36]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"remark",-1)),b(e("textarea",{"onUpdate:modelValue":t[16]||(t[16]=o=>s(n).remark=o),placeholder:"Remark",class:"border p-2 rounded w-full"},null,512),[[f,s(n).remark]])]),e("div",Se,[e("div",null,[d.previous_id?(i(),p("button",{key:0,onClick:t[17]||(t[17]=o=>r.$inertia.visit(`/assets/${d.previous_id}/edit`)),type:"button",class:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded mr-2"}," ← Previous ")):D("",!0),d.next_id?(i(),p("button",{key:1,onClick:t[18]||(t[18]=o=>r.$inertia.visit(`/assets/${d.next_id}/edit`)),type:"button",class:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded"}," Next → ")):D("",!0)]),e("button",{type:"submit",class:_(["bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",{"opacity-50 cursor-not-allowed":!C.value}]),disabled:!C.value}," Update ",10,$e)])],32)],512),[[j,v.value==="edit"]]),b(e("div",null,[k(ye,{transfers:d.transfers,users:d.users,locations:d.locations,asset:d.asset},null,8,["transfers","users","locations","asset"])],512),[[j,v.value==="transfer"]]),b(e("div",null,t[37]||(t[37]=[e("p",{class:"text-gray-600"},"Repair History will be shown here.",-1)]),512),[[j,v.value==="repair"]])])])]),_:1})],64))}};export{_e as default};
