import{a as F,r as $,x as B,c as p,o as i,b as e,m as A,F as x,j as V,t as w,i as P,h as b,v as f,u as l,f as k,w as y,l as g,e as T,k as M,d as q,q as W,g as G,n as _,T as J,p as j}from"./app-DjVUIijL.js";import{_ as K}from"./AuthenticatedLayout-B0f2gpQz.js";import{a as c,E as N}from"./AssetTransferHistory.vue_vue_type_style_index_0_lang-B_3CmWMw.js";import"./ApplicationLogo-ByYe_GGs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"min-w-full divide-y divide-gray-200 text-sm"},X={class:"bg-white divide-y divide-gray-200"},Y={class:"px-4 py-2 whitespace-nowrap"},Z={class:"px-4 py-2 whitespace-nowrap"},h={class:"px-4 py-2 whitespace-nowrap"},ee={class:"px-4 py-2 whitespace-nowrap"},te={class:"px-4 py-2 whitespace-nowrap space-x-2"},le=["onClick"],se=["onClick"],oe=["href"],ae={key:0},re={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4"},ne={class:"bg-white p-6 rounded shadow-lg w-full max-w-2xl relative"},de={class:"text-lg font-semibold mb-4"},ie={class:"md:col-span-2"},ue={class:"col-span-2 flex justify-end space-x-2 mt-4"},me={type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},be={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4"},pe={class:"bg-white p-6 rounded shadow-lg max-w-sm w-full relative"},fe={class:"flex justify-end space-x-2"},ve={__name:"AssetTransferHistory",props:{transfers:Array,users:Array,locations:Array,asset:Object},setup(d){const U=[...F().url.matchAll(/\/assets\/(\d+)/g)],v=U.length>0?U[U.length-1][1]:"";console.log("Asset ID:",v);const u=$(!1),n=$(!1),S=$(!1),C=$(null),E=d,r=B({id:null,asset_id:"",from_user_id:null,to_user_id:null,from_location:null,to_location:null,transfer_date:"",approved_by:"",reason:"",user_status:""}),t=()=>{r.reset(),n.value=!1,r.asset_id=v,u.value=!0},o=m=>{var s;r.id=m.id,r.asset_id=m.asset_id??((s=E.asset)==null?void 0:s.id)??"",r.from_user_id=m.from_user_id,r.to_user_id=m.to_user_id,r.from_location=m.from_location,r.to_location=m.to_location,r.transfer_date=m.transfer_date,r.approved_by=m.approved_by,r.reason=m.reason,r.user_status=m.user_status,n.value=!0,u.value=!0},H=m=>{C.value=m,S.value=!0},I=()=>{n.value?r.put(route("asset-transfers.update",r.id),{onSuccess:()=>u.value=!1,onError:m=>console.error("Update error:",m)}):r.post(route("asset-transfers.store"),{onSuccess:()=>u.value=!1,onError:m=>console.error("Create error:",m)})},O=()=>{C.value&&r.delete(`/asset-transfers/${C.value}`,{onSuccess:()=>{S.value=!1,C.value=null},onError:m=>console.error("Delete error:",m)})};return(m,s)=>(i(),p(x,null,[e("div",{class:"mb-4 text-right"},[e("button",{onClick:t,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," + Add Transfer ")]),e("table",Q,[s[11]||(s[11]=e("thead",null,[e("tr",{class:"bg-gray-50"},[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned User"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reason"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",X,[(i(!0),p(x,null,V(d.transfers,a=>{var L,R;return i(),p("tr",{key:a.id},[e("td",Y,w(new Date(a.transfer_date).toLocaleDateString()),1),e("td",Z,w(((L=d.users.find(D=>D.id===a.to_user_id))==null?void 0:L.name)||((R=d.users.find(D=>D.id===a.from_user_id))==null?void 0:R.name)||"N/A"),1),e("td",h,w(a.user_status),1),e("td",ee,w(a.reason||"-"),1),e("td",te,[e("button",{onClick:D=>o(a),class:"text-indigo-600 hover:underline"},"Edit",8,le),e("button",{onClick:D=>H(a.id),class:"text-red-600 hover:underline"},"Delete",8,se),e("a",{href:`${m.appUrl}/assets/${a.id}`,class:"text-green-600 hover:text-green-800 text-sm"}," Print ",8,oe)])])}),128)),d.transfers.length===0?(i(),p("tr",ae,s[10]||(s[10]=[e("td",{colspan:"5",class:"px-4 py-2 text-center text-gray-500"},"No transfer history found.",-1)]))):A("",!0)])]),u.value?(i(),p("div",re,[e("div",ne,[e("h2",de,w(n.value?"Edit Transfer":"Create Transfer"),1),e("form",{onSubmit:P(I,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[e("div",null,[s[12]||(s[12]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Asset ID",-1)),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>l(r).asset_id=a),class:"border p-2 rounded w-full bg-gray-100",readonly:""},null,512),[[f,l(r).asset_id]])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"From User",-1)),k(l(N),{modelValue:l(r).from_user_id,"onUpdate:modelValue":s[1]||(s[1]=a=>l(r).from_user_id=a),placeholder:"-- Select User --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.users&&d.users.length>0?(i(!0),p(x,{key:0},V(d.users,a=>(i(),g(l(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(l(c),{key:1,disabled:"",value:""},{default:y(()=>s[13]||(s[13]=[T("No users available")])),_:1,__:[13]}))]),_:1},8,["modelValue"])]),e("div",null,[s[16]||(s[16]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"To User",-1)),k(l(N),{modelValue:l(r).to_user_id,"onUpdate:modelValue":s[2]||(s[2]=a=>l(r).to_user_id=a),placeholder:"-- Select User --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.users&&d.users.length>0?(i(!0),p(x,{key:0},V(d.users,a=>(i(),g(l(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(l(c),{key:1,disabled:"",value:""},{default:y(()=>s[15]||(s[15]=[T("No users available")])),_:1,__:[15]}))]),_:1},8,["modelValue"])]),e("div",null,[s[18]||(s[18]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"From Location",-1)),k(l(N),{modelValue:l(r).from_location,"onUpdate:modelValue":s[3]||(s[3]=a=>l(r).from_location=a),placeholder:"-- Select Location --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.locations&&d.locations.length>0?(i(!0),p(x,{key:0},V(d.locations,a=>(i(),g(l(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(l(c),{key:1,disabled:"",value:""},{default:y(()=>s[17]||(s[17]=[T("No locations available")])),_:1,__:[17]}))]),_:1},8,["modelValue"])]),e("div",null,[s[20]||(s[20]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"To Location",-1)),k(l(N),{modelValue:l(r).to_location,"onUpdate:modelValue":s[4]||(s[4]=a=>l(r).to_location=a),placeholder:"-- Select Location --",filterable:"",clearable:"",class:"w-full"},{default:y(()=>[d.locations&&d.locations.length>0?(i(!0),p(x,{key:0},V(d.locations,a=>(i(),g(l(c),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):(i(),g(l(c),{key:1,disabled:"",value:""},{default:y(()=>s[19]||(s[19]=[T("No locations available")])),_:1,__:[19]}))]),_:1},8,["modelValue"])]),e("div",null,[s[21]||(s[21]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Transfer Date",-1)),b(e("input",{"onUpdate:modelValue":s[5]||(s[5]=a=>l(r).transfer_date=a),type:"date",class:"border p-2 rounded w-full"},null,512),[[f,l(r).transfer_date]])]),e("div",null,[s[23]||(s[23]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"User Status",-1)),b(e("select",{"onUpdate:modelValue":s[6]||(s[6]=a=>l(r).user_status=a),class:"border p-2 rounded w-full"},s[22]||(s[22]=[q('<option disabled value="">-- Select Status --</option><option value="available">Available</option><option value="assigned">Assigned</option><option value="repair">Repair</option><option value="retired">Retired</option>',5)]),512),[[M,l(r).user_status]])]),e("div",ie,[s[24]||(s[24]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Reason",-1)),b(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=a=>l(r).reason=a),class:"border p-2 rounded w-full"},null,512),[[f,l(r).reason]])]),e("div",ue,[e("button",{type:"button",onClick:s[8]||(s[8]=a=>u.value=!1),class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"},"Cancel "),e("button",me,w(n.value?"Update":"Submit"),1)])],32)])])):A("",!0),S.value?(i(),p("div",be,[e("div",pe,[s[25]||(s[25]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirm Delete",-1)),s[26]||(s[26]=e("p",{class:"mb-6"},"Are you sure you want to delete this transfer record?",-1)),e("div",fe,[e("button",{onClick:s[9]||(s[9]=a=>S.value=!1),class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"},"Cancel"),e("button",{onClick:O,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Delete")])])])):A("",!0)],64))}},ye={class:"max-w-7xl mx-auto p-6 bg-white rounded shadow mt-4"},xe={class:"mb-6 border-b border-gray-200"},ge={class:"flex space-x-6"},ce={key:0,class:"fixed-center bg-green-600 text-white px-6 py-3 rounded shadow-lg z-50"},ke=["value"],we=["value"],Ve={class:"md:col-span-3"},Ue={class:"md:col-span-3"},Se={class:"md:col-span-3 flex justify-between items-center"},Ce=["disabled"],Te={__name:"Edit",props:{asset:Object,users:Array,locations:Array,categories:Array,transfers:Array,next_id:Number,previous_id:Number},setup(d){var E;const{flash:z}=F().props,U=$(!1),v=$("edit"),u=d,n=B({asset_code:u.asset.asset_code,name:u.asset.name,category:((E=u.asset.category)==null?void 0:E.id)??"",model:u.asset.model,serial_number:u.asset.serial_number,vendor:u.asset.vendor,purchase_date:u.asset.purchase_date,purchase_cost:u.asset.purchase_cost,warranty_expiry:u.asset.warranty_expiry,account_id:u.asset.account_id,status:u.asset.status,current_location_id:u.asset.current_location_id,assigned_to_user_id:u.asset.assigned_to_user_id,notes:u.asset.notes,remark:u.asset.remark}),S=W(()=>n.isDirty),C=()=>{var r;if(!((r=u.asset)!=null&&r.id)){console.error("Asset ID is missing. Cannot submit the form.");return}n.put(route("assets.update",u.asset.id),{preserveScroll:!0,onSuccess:()=>{U.value=!0,setTimeout(()=>{U.value=!1},3e3)},onError:t=>{console.error("Form submission failed:",t),alert("There was an error updating the asset. Please check the fields and try again.")}})};return(r,t)=>(i(),p(x,null,[k(l(G),{title:"Edit Asset"}),k(K,null,{header:y(()=>t[19]||(t[19]=[e("h2",{class:"text-xl font-semibold text-gray-800"},"Edit Asset",-1)])),default:y(()=>[e("div",ye,[e("nav",xe,[e("ul",ge,[e("li",null,[e("button",{onClick:t[0]||(t[0]=o=>v.value="edit"),class:_([v.value==="edit"?"border-b-2 border-blue-600 text-blue-600 font-semibold":"text-gray-600 hover:text-blue-600","pb-2"])}," Edit Asset ",2)]),e("li",null,[e("button",{onClick:t[1]||(t[1]=o=>v.value="transfer"),class:_([v.value==="transfer"?"border-b-2 border-blue-600 text-blue-600 font-semibold":"text-gray-600 hover:text-blue-600","pb-2"])}," Transfer History ",2)]),e("li",null,[e("button",{onClick:t[2]||(t[2]=o=>v.value="repair"),class:_([v.value==="repair"?"border-b-2 border-blue-600 text-blue-600 font-semibold":"text-gray-600 hover:text-blue-600","pb-2"])}," Repair History ",2)])])]),e("div",null,[k(J,{name:"fade"},{default:y(()=>[U.value?(i(),p("div",ce," Asset updated successfully! ")):A("",!0)]),_:1}),b(e("div",null,[e("form",{onSubmit:P(C,["prevent"]),class:"grid grid-cols-1 md:grid-cols-3 gap-6"},[e("div",null,[t[20]||(t[20]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Asset Code",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>l(n).asset_code=o),placeholder:"Asset Code",class:"border p-2 rounded w-full"},null,512),[[f,l(n).asset_code]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Name",-1)),b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>l(n).name=o),placeholder:"Name",class:"border p-2 rounded w-full"},null,512),[[f,l(n).name]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Category",-1)),b(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>l(n).category=o),class:"border p-2 rounded w-full"},[t[22]||(t[22]=e("option",{disabled:"",value:""},"-- Select Category --",-1)),(i(!0),p(x,null,V(d.categories,o=>(i(),p("option",{key:o.id,value:o.id},w(o.category_name),9,ke))),128))],512),[[M,l(n).category]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Model",-1)),b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>l(n).model=o),placeholder:"Model",class:"border p-2 rounded w-full"},null,512),[[f,l(n).model]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Serial Number",-1)),b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>l(n).serial_number=o),placeholder:"Serial Number",class:"border p-2 rounded w-full"},null,512),[[f,l(n).serial_number]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Vendor",-1)),b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>l(n).vendor=o),placeholder:"Vendor",class:"border p-2 rounded w-full"},null,512),[[f,l(n).vendor]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Purchase Date",-1)),b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>l(n).purchase_date=o),type:"date",class:"border p-2 rounded w-full"},null,512),[[f,l(n).purchase_date]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Purchase Cost",-1)),b(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>l(n).purchase_cost=o),type:"number",placeholder:"Cost",class:"border p-2 rounded w-full"},null,512),[[f,l(n).purchase_cost]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Warranty Expiry",-1)),b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>l(n).warranty_expiry=o),type:"date",class:"border p-2 rounded w-full"},null,512),[[f,l(n).warranty_expiry]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"User Status",-1)),b(e("select",{"onUpdate:modelValue":t[12]||(t[12]=o=>l(n).status=o),class:"border p-2 rounded w-full"},t[30]||(t[30]=[e("option",{disabled:"",value:""},"-- Select User Status --",-1),e("option",{value:"instock"},"In Stock",-1),e("option",{value:"using"},"Using",-1),e("option",{value:"repair"},"Repair",-1),e("option",{value:"broken"},"Broken",-1)]),512),[[M,l(n).status]])]),e("div",null,[t[33]||(t[33]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Current Location",-1)),b(e("select",{"onUpdate:modelValue":t[13]||(t[13]=o=>l(n).current_location_id=o),class:"border p-2 rounded w-full"},[t[32]||(t[32]=e("option",{disabled:"",value:""},"-- Select Location --",-1)),(i(!0),p(x,null,V(d.locations,o=>(i(),p("option",{key:o.id,value:o.id},w(o.name),9,we))),128))],512),[[M,l(n).current_location_id]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Assigned User",-1)),k(l(N),{modelValue:l(n).assigned_to_user_id,"onUpdate:modelValue":t[14]||(t[14]=o=>l(n).assigned_to_user_id=o),placeholder:"-- Select Assigned User --",class:"w-full",filterable:""},{default:y(()=>[(i(!0),p(x,null,V(d.users,o=>(i(),g(l(c),{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",Ve,[t[35]||(t[35]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Notes",-1)),b(e("textarea",{"onUpdate:modelValue":t[15]||(t[15]=o=>l(n).notes=o),placeholder:"Notes",class:"border p-2 rounded w-full"},null,512),[[f,l(n).notes]])]),e("div",Ue,[t[36]||(t[36]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"remark",-1)),b(e("textarea",{"onUpdate:modelValue":t[16]||(t[16]=o=>l(n).remark=o),placeholder:"Remark",class:"border p-2 rounded w-full"},null,512),[[f,l(n).remark]])]),e("div",Se,[e("div",null,[d.previous_id?(i(),p("button",{key:0,onClick:t[17]||(t[17]=o=>r.$inertia.visit(`/assets/${d.previous_id}/edit`)),type:"button",class:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded mr-2"}," ← Previous ")):A("",!0),d.next_id?(i(),p("button",{key:1,onClick:t[18]||(t[18]=o=>r.$inertia.visit(`/assets/${d.next_id}/edit`)),type:"button",class:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded"}," Next → ")):A("",!0)]),e("button",{type:"submit",class:_(["bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",{"opacity-50 cursor-not-allowed":!S.value}]),disabled:!S.value}," Update ",10,Ce)])],32)],512),[[j,v.value==="edit"]]),b(e("div",null,[k(ve,{transfers:d.transfers,users:d.users,locations:d.locations,asset:d.asset},null,8,["transfers","users","locations","asset"])],512),[[j,v.value==="transfer"]]),b(e("div",null,t[37]||(t[37]=[e("p",{class:"text-gray-600"},"Repair History will be shown here.",-1)]),512),[[j,v.value==="repair"]])])])]),_:1})],64))}};export{Te as default};
